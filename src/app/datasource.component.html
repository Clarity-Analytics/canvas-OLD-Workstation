<!--Table with Datasources-->
<p-dataTable
  #dt
        columnResizeMode="expand"
        exportFilename="users"
        [contextMenu]="cm"
        [paginator]="true"
        [pageLinks]="3"
        [reorderableColumns]="true"
        [resizableColumns]="true"
        [responsive]="true"
        [rows]="10"
        [rowsPerPageOptions]="[5,10,20]"
        [(selection)]="selectedDatasource"
        selectionMode="single"
        [scrollable]="false"
        [sortMode]="multiple"
        [value]="datasources"
        (click)="onClickDatasourceTable()"
        >
    <p-column field="datasourceID" header="ID"></p-column>
    <p-column field="datasourceName" header="Name"></p-column>
    <p-column field="datasourceDescription" header="Description"></p-column>
</p-dataTable>


<!--Context (popup) menu  -->
<p-contextMenu #cm [model]="popuMenuItems"></p-contextMenu>


<!--Popup for User Membership panel-->
<div
    class="groupMembershipPanel"
    *ngIf="displayUserDatasourceAccess"
    >

    <div
        class="groupMembershipHeading"
        >
        User Membership for {{ selectedDatasource.datasourceName }}
        <button
            class="panelButtonWithLabel"
            pButton
            type="button"
            label="Cancel"
            icon="fa-undo"
            (click)="onClickUserMembershipCancel()"
            >
        </button>
    </div>

    <!--Content-->
    <form>

        <div
            >
            <p-pickList
                [source]="availableUserDatasource"
                [target]="belongstoUserDatasource"
                sourceHeader="Available Users"
                targetHeader="Users with access"
                (onMoveToTarget)="onMoveToTargetDatasourceUserMembership($event)"
                (onMoveToSource)="onMoveToSourceDatasourceUserMembership($event)"
                >
                <ng-template let-usr pTemplate="item">
                    <div class="ui-helper-clearfix">
                        <div
                            style="font-size:14px;float:left;margin:15px 5px 0 0"
                            >
                            {{ usr.username }}
                        </div>
                    </div>
                </ng-template>
            </p-pickList>

        </div>

    </form>
</div>




<!--Popup to List User Access-->
<p-dialog
    [(visible)]="displayUserAccess"
    header="Users with access"
    [closeOnEscape]=false
    [closable]=true
    modal="true"
    responsive="true"
    >
    <p-dataTable  #dt
        columnResizeMode="expand"
        exportFilename="users"
        [contextMenu]="cm"
        [paginator]="true"
        [pageLinks]="3"
        [reorderableColumns]="true"
        [resizableColumns]="true"
        [responsive]="true"
        [rows]="10"
        [rowsPerPageOptions]="[5,10,20]"
        [(selection)]="selectedUser"
        selectionMode="single"
        [scrollable]="false"
        [sortMode]="multiple"
        [value]="users"
        >
        <p-header
            [style]="{'background-color': 'darkgray'}">
            <span>
                List of Users with Access
            </span>
            <span style="float:right"
                class="ui-helper-clearfix csvButton"
                >
                <button
                    type="button"
                    pButton
                    icon="fa-file-o"
                    iconPos="left"
                    label="CSV"
                    (click)="dt.exportCSV()"
                    >
                </button>
            </span>

        </p-header>
        <p-column
            field="username"
            [filter]="true"
            filterMatchMode="contains"
            header="UserName"
            [sortable]="true"
            [style]="{width: '80px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="firstName"
            [filter]="true"
            filterMatchMode="contains"
            header="FirstName"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="lastName"
            [filter]="true"
            filterMatchMode="contains"
            header="LastName"
            [sortable]="true"
            >
        </p-column>
        <p-column field="nickName"
            [filter]="true"
            filterMatchMode="contains"
            header="NickName"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="lastDatetimeLoggedIn"
            [filter]="true"
            filterMatchMode="contains"
            header="Last Login"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="emailAddress"
            [filter]="true"
            filterMatchMode="contains"
            header="Email"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="cellNumber"
            [filter]="true"
            filterMatchMode="contains"
            header="Cell"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="workTelephoneNumber"
            [filter]="true"
            filterMatchMode="contains"
            header="Work Tel"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="activeFromDate"
            [filter]="true"
            filterMatchMode="contains"
            header="Active From"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="inactiveDate"
            [filter]="true"
            filterMatchMode="contains"
            header="Inactive Date"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="isStaff"
            [filter]="true"
            filterMatchMode="contains"
            header="Is Staff"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
    </p-dataTable>
</p-dialog>


<!--Popup for Group Membership panel-->
<div
    class="groupMembershipPanel"
    *ngIf="displayGroupMembership"
    >

    <div
        class="groupMembershipHeading"
        >
        Group Membership for {{ selectedDatasource.datasourceName }}
        <button
            class="panelButtonWithLabel"
            pButton
            type="button"
            label="Cancel"
            icon="fa-undo"
            (click)="onClickGroupMembershipCancel()"
            >
        </button>
    </div>

    <!--Content-->
    <form>

        <div
            >
            <p-pickList
                [source]="availableDatasourceGroupMembership"
                [target]="belongstoDatasourceGroupMembership"
                sourceHeader="Available Groups"
                targetHeader="Belongs to these Groups"
                (onMoveToTarget)="onMoveToTargetDatasourceGroupMembership($event)"
                (onMoveToSource)="onMoveToSourceDatasourceGroupMembership($event)"
                >
                <ng-template let-grp pTemplate="item">
                    <div class="ui-helper-clearfix">
                        <div
                            style="font-size:14px;float:left;margin:15px 5px 0 0"
                            >
                            {{ grp.groupName }}
                        </div>
                    </div>
                </ng-template>
            </p-pickList>

        </div>

    </form>
</div>


<!--Popup to List Group Access-->
<p-dialog
    [(visible)]="displayGroupAccess"
    header="Groups with access"
    [closeOnEscape]=false
    [closable]=true
    modal="true"
    responsive="true"
    >
    <p-dataTable  #dt
        columnResizeMode="expand"
        exportFilename="groups"
        [paginator]="false"
        [pageLinks]="3"
        [reorderableColumns]="true"
        [resizableColumns]="true"
        [responsive]="true"
        [rows]="10"
        [rowsPerPageOptions]="[5,10,20]"
        [(selection)]="selectedGroup"
        selectionMode="single"
        [scrollable]="true"
        [sortMode]="multiple"
        [value]="groups"
        >
        <p-header
            [style]="{'background-color': 'darkgray'}">
            <span>
                List of Groups
            </span>
            <span style="float:right"
                class="ui-helper-clearfix csvButton"
                >
                <button
                    type="button"
                    pButton
                    icon="fa-file-o"
                    iconPos="left"
                    label="CSV"
                    (click)="dt.exportCSV()"
                    >
                </button>
            </span>

        </p-header>
        <p-column
            field="groupID"
            [filter]="false"
            filterMatchMode="contains"
            header="ID"
            [sortable]="true"
            [style]="{width: '80px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="groupName"
            [filter]="false"
            filterMatchMode="contains"
            header="Name"
            [sortable]="true"
            [style]="{width: '120px',
                    'text-align': 'center'}"
            >
        </p-column>
        <p-column
            field="groupDescription"
            [filter]="false"
            filterMatchMode="contains"
            header="Description"
            [sortable]="true"
            [style]="{width: '320px',
                    'text-align': 'center'}"            >
        </p-column>
    </p-dataTable>
</p-dialog>


<!--Reports linked-->
<p-dialog
    [(visible)]="displayReports"
    header="Linked Reports"
    [closeOnEscape]=false
    [closable]=true
    modal="true"
    responsive="true"
    >
    <p-dataTable [value]="reports">
        <p-column field="reportID" header="ID"></p-column>
        <p-column field="reportName" header="Name"></p-column>
        <p-column field="description" header="Description"></p-column>
        <p-column field="reportParameters" header="Parameters"></p-column>
        <p-column field="dataSourceID" header="DS ID"></p-column>
        <p-column field="dataSourceParameters" header="DS Parameters"></p-column>
        <p-column field="reportFieldsString" header="Fields"></p-column>
    </p-dataTable>
</p-dialog>